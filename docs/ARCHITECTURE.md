# 오픈해시 시스템 아키텍처

## 개요

오픈해시는 기존 통신 인프라의 물리적 계층 구조를 활용하여 에너지 효율적인 데이터 무결성 검증을 제공합니다.

## 계층 구조
```
┌─────────────────────────────────────────────────────────────┐
│                    Layer 4: Cloud Archive                    │
│                    (c7i-flex.large × 2)                     │
│                    - 영구 저장소                             │
│                    - CRYSTALS-Dilithium (양자 내성)         │
└─────────────────────────────────────────────────────────────┘
                              ▲
                              │
┌─────────────────────────────────────────────────────────────┐
│                    Layer 3: Core Engine                      │
│                    (t3.small × 1)                           │
│                    - Representative 노드                     │
│                    - PBFT 합의 (7-of-10)                    │
└─────────────────────────────────────────────────────────────┘
                              ▲
                              │
┌─────────────────────────────────────────────────────────────┐
│                    Layer 2: Edge Server                      │
│                    (t3.small × 2)                           │
│                    - 지역 집계                               │
│                    - BLS 서명 집약                          │
└─────────────────────────────────────────────────────────────┘
                              ▲
                              │
┌─────────────────────────────────────────────────────────────┐
│                    Layer 1: Edge Device                      │
│                    (t3.micro × 6)                           │
│                    - IoT, 모바일 단말                        │
│                    - 경량 서명 (ECDSA P-256)                │
└─────────────────────────────────────────────────────────────┘
```

## 핵심 알고리즘

### 1. 확률적 계층 선택
```python
N = SHA256(SHA256(document_hash || timestamp)) mod 100

if N < 70:
    layer = Layer1  # 70% 확률
elif N < 90:
    layer = Layer2  # 20% 확률
else:
    layer = Layer3  # 10% 확률
```

### 2. 계층 간 상호 검증

- **하향식**: 상위 계층이 BLS 서명 + Merkle Proof로 하위 계층 검증
- **상향식**: 하위 계층이 상위 계층의 이상 동작 감시

### 3. LPBFT 합의

- 조건: n ≥ 3f + 1
- 합의: 2f + 1 동의 필요
- 10노드 기준: 7-of-10 합의

## 성능 지표

| 지표 | 값 |
|------|------|
| 노드당 TPS | 80 |
| 평균 지연 | 4 ms |
| 에너지 절감 | 98.5% |
| vs 비트코인 | 68.8x |
