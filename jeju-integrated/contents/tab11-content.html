<style>
    .ai-site-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem;
    }
    
    .ai-site-header {
        background: white;
        border: 2px solid #0B4DA2;
        padding: 2rem;
        margin-bottom: 2rem;
    }
    
    .ai-site-header h1 {
        color: #000000;
        margin: 0 0 0.5rem 0;
        font-size: 28px;
        font-weight: 700;
    }
    
    .ai-site-header p {
        color: #4B5563;
        margin: 0;
        font-size: 14px;
    }
    
    .info-panel {
        background: #F0F4F8;
        border-left: 4px solid #0B4DA2;
        padding: 24px;
        margin: 2rem 0;
        line-height: 1.8;
    }
    
    .info-panel p {
        margin-bottom: 16px;
        color: #1F2937;
        font-size: 14px;
    }
    
    .info-panel p:last-child {
        margin-bottom: 0;
    }
    
    .button-container {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin: 3rem 0;
    }
    
    .btn-large {
        background: #0B4DA2;
        color: white;
        padding: 1.5rem 3rem;
        border: none;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        border-radius: 4px;
    }
    
    .btn-large:hover {
        background: #003876;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(11, 77, 162, 0.3);
    }
    
    /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: 9998;
        backdrop-filter: blur(2px);
    }
    
    .modal-overlay.active {
        display: flex;
        justify-content: center;
        align-items: center;
    }
    
    .modal-panel {
        background: white;
        width: 90%;
        max-width: 800px;
        max-height: 85vh;
        overflow-y: auto;
        border-radius: 8px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        position: relative;
        animation: modalSlideIn 0.3s ease-out;
    }
    
    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: translateY(-50px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .modal-header {
        background: #0B4DA2;
        color: white;
        padding: 1.5rem 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-radius: 8px 8px 0 0;
    }
    
    .modal-header h2 {
        margin: 0;
        font-size: 20px;
        font-weight: 700;
    }
    
    .modal-close {
        background: transparent;
        border: none;
        color: white;
        font-size: 28px;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        transition: background 0.2s;
    }
    
    .modal-close:hover {
        background: rgba(255, 255, 255, 0.2);
    }
    
    .modal-content {
        padding: 2rem;
    }
    
    /* ê²€ìƒ‰ ìŠ¤íƒ€ì¼ */
    .search-input {
        width: 100%;
        padding: 0.75rem;
        border: 2px solid #E5E7EB;
        font-size: 14px;
        margin-bottom: 1rem;
        border-radius: 4px;
    }
    
    .search-input:focus {
        outline: none;
        border-color: #0B4DA2;
    }
    
    .btn-primary {
        background: #0B4DA2;
        color: white;
        padding: 0.75rem 2rem;
        border: none;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s;
        border-radius: 4px;
    }
    
    .btn-primary:hover {
        background: #003876;
    }
</style>

<div class="ai-site-container">
    <div class="ai-site-header">
        <h1>ğŸŒ AI ì‚¬ì´íŠ¸</h1>
        <p>ëª¨ë“  ì›¹ì‚¬ì´íŠ¸ë¥¼ í•˜ë‚˜ì˜ AI ì‚¬ì´íŠ¸ë¡œ í†µí•©í•©ë‹ˆë‹¤</p>
    </div>
    
    <div class="info-panel">
        <p><strong>ì œì£¼ë„ì—ëŠ” ì œì£¼í•­ê³µ, ì œì£¼ ê°ê·¤, ì œì£¼ëŒ€í•™êµ, ì œì£¼ëŒ€í•™ë³‘ì›, ì œì£¼ì§€ë°©ë²•ì›, ì œì£¼ë„ì²­, ì‚¼ì¼ê³µì‚¬, ë‹¤ì‚¬ë‘ íšŸì§‘, ë†í˜‘, ì œì£¼ì€í–‰ ë“± 10ë§Œ ì—¬ ê°œì˜ ë‹¤ì–‘í•œ ì›¹ì‚¬ì´íŠ¸ë“¤ì´ ìˆìŠµë‹ˆë‹¤.</strong></p>
        
        <p>ê·€í•˜ê°€ <strong>ë„ì²­ì— ìš©ë¬´ê°€ ìˆê±°ë‚˜, ì€í–‰ ê³„ì¢Œì—ì„œ ëˆ„êµ°ê°€ì—ê²Œ ì†¡ê¸ˆí•˜ê±°ë‚˜, í•­ê³µê¶Œì„ êµ¬ë§¤í•˜ê±°ë‚˜, ì—¬íƒ€ ìƒí’ˆì„ êµ¬ë§¤</strong>í•  ë•Œ, ê·€í•˜ëŠ” í•´ë‹¹ ê¸°ê´€ì´ë‚˜ ê¸°ì—…ì˜ ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ê±°ë‚˜, ì•±ì„ ì´ìš©í•´ì•¼ í•©ë‹ˆë‹¤.</p>
        
        <p><strong>ì´ í˜ì´ì§€ëŠ” ì´ ëª¨ë“  ì›¹ì‚¬ì´íŠ¸ë“¤ì„ í•˜ë‚˜ì˜ AI ì‚¬ì´íŠ¸ë¡œ í†µí•©í•©ë‹ˆë‹¤.</strong> AI ì‚¬ì´íŠ¸ëŠ” ê·€í•˜ê°€ ì›í•˜ëŠ” ì •ë³´ë‚˜ ì—…ë¬´ ìˆ˜í–‰ì„ AI ìƒë‹´ì›ì´ ëŒ€í–‰í•©ë‹ˆë‹¤.</p>
    </div>
    
    <div class="button-container">
        <button class="btn-large" onclick="openGeneratorModal()">â• ì‚¬ì´íŠ¸ ìƒì„±</button>
        <button class="btn-large" onclick="openSearchModal()">ğŸ” AI ì‚¬ì´íŠ¸ ê²€ìƒ‰</button>
    </div>
</div>

<!-- ì‚¬ì´íŠ¸ ìƒì„± ëª¨ë‹¬ -->
<div id="generatorModal" class="modal-overlay" onclick="closeModalOnOverlay(event, 'generatorModal')">
    <div class="modal-panel" onclick="event.stopPropagation()">
        <div class="modal-header">
            <h2>ğŸ¤– AI ì‚¬ì´íŠ¸ ìƒì„± ìƒë‹´</h2>
            <button class="modal-close" onclick="closeModal('generatorModal')">&times;</button>
        </div>
        <div class="modal-content" id="generatorContent">
            <div style="text-align: center; padding: 2rem; color: #6B7280;">
                ì‚¬ì´íŠ¸ ìƒì„± AIë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
            </div>
        </div>
    </div>
</div>

<!-- AI ì‚¬ì´íŠ¸ ê²€ìƒ‰ ëª¨ë‹¬ -->
<div id="searchModal" class="modal-overlay" onclick="closeModalOnOverlay(event, 'searchModal')">
    <div class="modal-panel" onclick="event.stopPropagation()">
        <div class="modal-header">
            <h2>ğŸ” AI ì‚¬ì´íŠ¸ ê²€ìƒ‰</h2>
            <button class="modal-close" onclick="closeModal('searchModal')">&times;</button>
        </div>
        <div class="modal-content">
            <p style="margin-bottom: 1rem; color: #4B5563;">ìƒí˜¸ëª…, ì„±ëª…, ê³ ìœ ë²ˆí˜¸, ì „í™”ë²ˆí˜¸ë¡œ ê²€ìƒ‰í•˜ì„¸ìš”</p>
            <input type="text" class="search-input" id="siteSearchInput" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
            <button class="btn-primary" onclick="searchAISite()">ê²€ìƒ‰</button>
            <div id="searchResults" style="margin-top: 2rem;"></div>
        </div>
    </div>
</div>

<div id="previewModule"></div>

<script>
(function() {
    // ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸°
    window.openGeneratorModal = async function() {
        const modal = document.getElementById('generatorModal');
        modal.classList.add('active');
        
        // ì‚¬ì´íŠ¸ ìƒì„± ëª¨ë“ˆ ë¡œë“œ (í•œ ë²ˆë§Œ)
        if (!window.generatorLoaded) {
            await loadGeneratorModule();
            window.generatorLoaded = true;
        }
    };
    
    window.openSearchModal = function() {
        const modal = document.getElementById('searchModal');
        modal.classList.add('active');
        document.getElementById('siteSearchInput').focus();
    };
    
    window.closeModal = function(modalId) {
        const modal = document.getElementById(modalId);
        modal.classList.remove('active');
    };
    
    window.closeModalOnOverlay = function(event, modalId) {
        if (event.target.classList.contains('modal-overlay')) {
            closeModal(modalId);
        }
    };
    
    // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeModal('generatorModal');
            closeModal('searchModal');
        }
    });
    
    // ì‚¬ì´íŠ¸ ìƒì„± ëª¨ë“ˆ ë¡œë“œ
    async function loadGeneratorModule() {
        const container = document.getElementById('generatorContent');
        
        try {
            const response = await fetch('contents/modules/site-generator.html');
            if (!response.ok) throw new Error('ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨');
            
            const html = await response.text();
            container.innerHTML = html;
            
            const scripts = container.querySelectorAll('script');
            scripts.forEach(script => {
                const newScript = document.createElement('script');
                newScript.textContent = script.textContent;
                document.body.appendChild(newScript);
                script.remove();
            });
        } catch (error) {
            console.error('ëª¨ë“ˆ ë¡œë“œ ì˜¤ë¥˜:', error);
            container.innerHTML = '<div style="text-align:center;padding:2rem;color:#DC2626;">ëª¨ë“ˆì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</div>';
        }
    }

    // ì‚¬ì´íŠ¸ ê²€ìƒ‰
    window.searchAISite = function() {
        const query = document.getElementById('siteSearchInput').value.trim();
        const resultsDiv = document.getElementById('searchResults');
        
        if (!query) {
            resultsDiv.innerHTML = '<p style="color: #DC2626;">ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>';
            return;
        }
        
        const sites = JSON.parse(localStorage.getItem('aiSites') || '[]');
        const found = sites.filter(site => 
            site.businessName?.includes(query) ||
            site.ownerName?.includes(query) ||
            site.businessNumber === query ||
            site.phone === query
        );
        
        if (found.length === 0) {
            resultsDiv.innerHTML = '<p style="color: #6B7280;">ê²€ìƒ‰ëœ ì‚¬ì´íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            return;
        }
        
        const html = found.map((site, index) => `
            <div style="border: 2px solid #E5E7EB; padding: 1rem; margin-bottom: 1rem; border-radius: 4px;">
                <div style="font-size: 18px; font-weight: 700; color: #1F2937; margin-bottom: 0.5rem;">
                    ${site.businessName || 'ì´ë¦„ ì—†ìŒ'}
                </div>
                <div style="font-size: 14px; color: #6B7280; margin: 0.25rem 0;">
                    ğŸ“ ${site.address || 'ì£¼ì†Œ ì—†ìŒ'}
                </div>
                <div style="font-size: 14px; color: #6B7280; margin: 0.25rem 0;">
                    ğŸ“ ${site.phone || 'ì—°ë½ì²˜ ì—†ìŒ'}
                </div>
                <button class="btn-primary" style="margin-top: 0.5rem;" onclick="viewSite(${sites.indexOf(site)})">
                    ì‚¬ì´íŠ¸ ë³´ê¸°
                </button>
            </div>
        `).join('');
        
        resultsDiv.innerHTML = `
            <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 1rem;">
                ê²€ìƒ‰ ê²°ê³¼ (${found.length}ê°œ)
            </h3>
            ${html}
        `;
    };

    // ì‚¬ì´íŠ¸ ë³´ê¸°
    window.viewSite = function(index) {
        const sites = JSON.parse(localStorage.getItem('aiSites') || '[]');
        if (sites[index]) {
            closeModal('searchModal');
            window.loadSitePreview(sites[index]);
        }
    };
    
    // ì‚¬ì´íŠ¸ í”„ë¦¬ë·° ë¡œë“œ
    window.loadSitePreview = async function(siteData) {
        const container = document.getElementById('previewModule');
        container.innerHTML = '<div style="text-align:center;padding:2rem;color:#6B7280;">ì‚¬ì´íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ì¤‘...</div>';
        
        try {
            const response = await fetch('contents/modules/site-preview.html');
            if (!response.ok) throw new Error('í”„ë¦¬ë·° ëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨');
            
            const html = await response.text();
            container.innerHTML = html;
            
            const scripts = container.querySelectorAll('script');
            scripts.forEach(script => {
                const newScript = document.createElement('script');
                newScript.textContent = script.textContent;
                document.body.appendChild(newScript);
                script.remove();
            });
            
            setTimeout(() => {
                if (window.renderSitePreview) {
                    window.renderSitePreview(siteData);
                }
            }, 100);
        } catch (error) {
            console.error('í”„ë¦¬ë·° ë¡œë“œ ì˜¤ë¥˜:', error);
            container.innerHTML = '<div style="text-align:center;padding:2rem;color:#DC2626;">í”„ë¦¬ë·°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</div>';
        }
    };
})();
</script>
